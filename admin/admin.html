<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel - Manage Events</title>
    <link rel="stylesheet" href="style.css">
    <script>
        // Function to fetch events for admin management
        function fetchEvents() {
            const xhr = new XMLHttpRequest();
            xhr.open('GET', 'http://localhost/fetch_events.php', true);

            xhr.onload = function() {
                if (this.status === 200) {
                    const events = JSON.parse(this.responseText);
                    const adminEventsContainer = document.getElementById('admin-events-container');

                    adminEventsContainer.innerHTML = ''; // Clear previous content

                    if (events.length > 0) {
                        events.forEach(event => {
                            const eventCard = document.createElement('div');
                            eventCard.classList.add('event-card');
                            eventCard.innerHTML = `
                                <h3>${event.event_name}</h3>
                                <p><strong>Date:</strong> ${event.event_date}</p>
                                <p><strong>Time:</strong> ${event.event_time}</p>
                                <p><strong>Location:</strong> ${event.location}</p>
                                <p><strong>Description:</strong> ${event.description}</p>
                                <button onclick="deleteEvent(${event.event_id})">Delete</button>
                                <button onclick="editEvent(${event.event_id})">Edit</button>
                            `;
                            adminEventsContainer.appendChild(eventCard);
                        });
                    } else {
                        adminEventsContainer.innerHTML = '<p>No events available.</p>';
                    }
                }
            };

            xhr.onerror = function() {
                document.getElementById('admin-events-container').innerHTML = '<p>Error loading events.</p>';
            };

            xhr.send();
        }

        // Function to delete an event
        function deleteEvent(event_id) {
            if (confirm("Are you sure you want to delete this event?")) {
                const xhr = new XMLHttpRequest();
                xhr.open('POST', 'delete_event.php', true);
                xhr.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
                xhr.onload = function() {
                    if (this.status === 200) {
                        alert('Event deleted successfully!');
                        fetchEvents(); // Refresh events list
                    } else {
                        alert('Error deleting event.');
                    }
                };
                xhr.send(`event_id=${event_id}`);
            }
        }

        // Call fetchEvents when the page loads
        window.onload = fetchEvents;
    </script>
</head>
<body>

    <!-- Header -->
    <header>
        <h1>Admin Panel - Manage Events</h1>
    </header>

    <!-- Admin Events Section -->
    <div class="container">
        <div class="section" id="admin-events">
            <h2>Manage Events</h2>
            <div id="admin-events-container">
                <!-- Event cards for admin management will be added here -->
            </div>
        </div>

        <!-- Add Event Form -->
        <div class="section">
            <h2>Add Event</h2>
            <form action="add_event.php" method="POST">
                <label for="event_name">Event Name:</label>
                <input type="text" id="event_name" name="event_name" required>

                <label for="event_date">Event Date:</label>
                <input type="date" id="event_date" name="event_date" required>

                <label for="event_time">Event Time:</label>
                <input type="time" id="event_time" name="event_time" required>

                <label for="location">Location:</label>
                <input type="text" id="location" name="location" required>

                <label for="description">Description:</label>
                <textarea id="description" name="description" rows="4" required></textarea>

                <button type="submit">Add Event</button>
            </form>
        </div>
    </div>

</body>
</html>
